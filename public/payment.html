<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment - Wapangaji</title>
    <link rel="stylesheet" href="css/auth.css">
    <style>
        .payment-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        .payment-options {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        .payment-option {
            padding: 15px 25px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .payment-option:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        .payment-option.selected {
            border-color: #007bff;
            background: #e3f2fd;
            font-weight: bold;
        }
        .amount-display {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
            margin: 20px 0;
        }
        .pay-button {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        .pay-button:hover {
            background: #218838;
        }
        .pay-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #dc3545;
            margin: 20px 0;
        }
        .role-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="payment-container">
        <h1>Complete Your Payment</h1>
        
        <div class="role-info">
            <h3 id="roleTitle">Dalali Registration Fee</h3>
            <p id="roleDescription">As a dalali, you'll be able to list up to 5 houses for rent and connect with potential tenants.</p>
        </div>
        
        <div class="amount-display">
            Amount: $<span id="amount">10.00</span>
        </div>
        
        <div class="timer">
            Time remaining: <span id="timer">10:00</span>
        </div>
        
        <h3>Select Payment Method:</h3>
        <div class="payment-options">
            <div class="payment-option" onclick="selectPaymentMethod('mpesa')">
                <div>M-Pesa</div>
                <div style="font-size: 0.8em; margin-top: 5px;">***123#</div>
            </div>
            <div class="payment-option" onclick="selectPaymentMethod('airtel')">
                <div>Airtel Money</div>
                <div style="font-size: 0.8em; margin-top: 5px;">*150*60#</div>
            </div>
            <div class="payment-option" onclick="selectPaymentMethod('halopesa')">
                <div>HaloPesa</div>
                <div style="font-size: 0.8em; margin-top: 5px;">*150#</div>
            </div>
        </div>
        
        <button id="payButton" class="pay-button" onclick="processPayment()" disabled>
            Pay Now
        </button>
        
        <p style="margin-top: 30px;">
            <a href="index.html">‚Üê Back to Home</a>
        </p>
    </div>

    <script>
        // User role - in a real app this would come from authentication
        // For now, we'll assume the user registered as "dalali"
        const userRole = 'dalali';
        let selectedPaymentMethod = null;
        let timeRemaining = 600; // 10 minutes in seconds
        
        // Set role-specific content
        if (userRole === 'dalali') {
            document.getElementById('roleTitle').textContent = 'Dalali Registration Fee';
            document.getElementById('roleDescription').textContent = 'As a dalali, you\'ll be able to list up to 5 houses for rent and connect with potential tenants.';
            document.getElementById('amount').textContent = '10.00';
        } else if (userRole === 'mpangaji') {
            document.getElementById('roleTitle').textContent = 'Mpangaji Registration Fee';
            document.getElementById('roleDescription').textContent = 'As an mpangaji, you\'ll be able to search for houses and connect with agents.';
            document.getElementById('amount').textContent = '5.00';
        } else {
            document.getElementById('roleTitle').textContent = 'Mwenyenyumba Registration Fee';
            document.getElementById('roleDescription').textContent = 'As an mwenyenyumba, you\'ll be able to search for houses and connect with agents.';
            document.getElementById('amount').textContent = '5.00';
        }
        
        // Select payment method
        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            
            // Update UI to show selected method
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            document.getElementById('payButton').disabled = false;
        }
        
        // Process payment
        function processPayment() {
            if (!selectedPaymentMethod) {
                alert('Please select a payment method');
                return;
            }
            
            // Simulate payment processing
            document.getElementById('payButton').disabled = true;
            document.getElementById('payButton').textContent = 'Processing...';
            
            // Simulate payment delay
            setTimeout(() => {
                // Payment successful
                alert(`Payment of $${document.getElementById('amount').textContent} via ${selectedPaymentMethod} was successful!`);
                
                // Redirect to appropriate dashboard
                if (userRole === 'dalali') {
                    window.location.href = 'dalali_dashboard.html';
                } else {
                    window.location.href = 'mpangaji-dashboard.html';
                }
            }, 2000);
        }
        
        // Timer countdown
        function updateTimer() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timer').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (timeRemaining > 0) {
                timeRemaining--;
                setTimeout(updateTimer, 1000);
            } else {
                alert('Payment session expired. Please refresh the page to try again.');
                document.getElementById('payButton').disabled = true;
                document.getElementById('payButton').textContent = 'Session Expired';
            }
        }
        
        // Start timer
        updateTimer();
    </script>
</body>
</html>